"use strict";var _createClass=function(){function e(t,n){for(var s=0;s<n.length;s++){var e=n[s];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}();function _classCallCheck(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.prototype.prepend=function(t){return this.innerHTML=t+this.innerHTML,this};var Carousel=function(){function n(t){_classCallCheck(this,n),this.attrs={warp:t.warp,main:t.main,startPos:"",endPos:"",play:t.play||!1,time:t.time||2e3,horizontal:t.horizontal||!1,point:t.point||!1,pointColor:t.pointColor||"blue",pointSize:t.pointSize||"6px",touch:t.touch||!1},this.index=0}return _createClass(n,[{key:"init",value:function(){var s=this;this._warp=document.querySelector("."+this.attrs.warp),this._main=document.querySelectorAll("."+this.attrs.main),this._mainLen=this._main.length;var e=this._warp.offsetHeight,i=this._warp.offsetWidth;this.warpH=e,this.warpW=i;var t=this._main[0].cloneNode(!0),n=this._main[this._main.length-1].cloneNode(!0);this._warp.appendChild(t),this._warp.prepend(n),this._warp.childNodes.forEach(function(t,n){1===t.nodeType&&(t.style.height=e+"px",s.attrs.horizontal?t.style.left=i*(n/2-1)+"px":t.style.top=e*(n/2-1)+"px",t.index=n/2-1)}),this.attrs.touch&&this.handleMoveEventListener(),this.attrs.play&&this.handlePlayer(),this.attrs.point&&(this.createPoint(),this.handlePoint(this.index))}},{key:"createPoint",value:function(){var s=this,t=document.createElement("style"),n=this._warp.parentNode;n.style.position="relative";var e=document.createElement("div");e.className="point-dom-"+this.attrs.horizontal,this._main.forEach(function(t,n){e.innerHTML+="<span class='point-list-"+s.attrs.horizontal+"' data-tap='"+n+"'>‚óè</span>"}),this.attrs.horizontal?t.innerHTML="\n          .point-dom-true {\n            position: absolute;\n            bottom: 10px;\n            left: 50%;\n            transform: translate(-50%, 0);\n          }\n          .point-list-true {\n            margin-right: 5px;\n            font-size: "+this.attrs.pointSize+";\n          }\n          .point-dom-true .selected-point-list {\n            color: "+this.attrs.pointColor+";\n          }\n        ":t.innerHTML="\n        .point-dom-false {\n          position: absolute;\n          top: 50%;\n          left: 30px;\n          transform: translate(0, -50%);\n        }\n        .point-list-false {\n          margin-right: 5px;\n          display: block;\n          font-size: "+this.attrs.pointSize+";\n        }\n        .point-dom-false .selected-point-list {\n          color: "+this.attrs.pointColor+";\n        }\n      ",n.appendChild(e),n.appendChild(t),this.pointList=e.childNodes}},{key:"handleMoveEventListener",value:function(){this._warp.addEventListener("touchstart",this.handleTouchStart.bind(this)),this._warp.addEventListener("touchend",this.handleTouchEnd.bind(this))}},{key:"handleTouchStart",value:function(t){t.preventDefault(),this.attrs.startPos=t.touches[0].pageY,this.attrs.startPosX=t.touches[0].pageX,this.attrs.endPos="",new RegExp(this.attrs.main).test(t.target.className)?this.index=t.target.index:this.index=t.target.parentNode.index,clearInterval(this.interval),this._warp.addEventListener("touchmove",this.handleTouchMove.bind(this))}},{key:"handleTouchMove",value:function(t){t.preventDefault(),this.attrs.endPos=t.touches[0].pageY,this.attrs.endPosX=t.touches[0].pageX}},{key:"handleTouchEnd",value:function(){this.attrs.horizontal&&""!==this.attrs.endPos?10<this.attrs.endPosX-this.attrs.startPosX?this.prev():this.attrs.endPosX-this.attrs.startPosX<-10&&this.next():10<this.attrs.endPos-this.attrs.startPos?this.prev():this.attrs.endPos-this.attrs.startPos<-10&&this.next(),this.attrs.play&&this.handlePlayer()}},{key:"prev",value:function(){if(this.index=this.index-1,this.index<0)return this.index=-1,void this.domShow(this.index);this.domShow(this.index)}},{key:"next",value:function(){if(this.index=this.index+1,this.index>=this._mainLen)return this.index=this._mainLen,void this.domShow(this.index);this.domShow(this.index)}},{key:"handlePoint",value:function(n){-1===n?n=this._mainLen-1:n===this._mainLen&&(n=0),this.pointList.forEach(function(t){t.getAttribute("data-tap")===n.toString()?(t.className=t.className.replace(/selected-point-list/,""),t.className+=" selected-point-list"):t.className=t.className.replace(/\s+selected-point-list/,"")})}},{key:"domShow",value:function(t){var n=this;this.attrs.horizontal?-1===t?(this.index=this._mainLen,this._warp.style.cssText="transform: translate3d("+1*this.warpW+"px, 0, 0); transition: transform .5s",setTimeout(function(){n._warp.style.cssText="transform: translate3d("+-(n._mainLen-1)*n.warpW+"px, 0, 0);"},550)):this._warp.style.cssText="transform: translate3d("+-t*this.warpW+"px, 0,0); transition: transform .5s":-1===t?(this.index=this._mainLen,this._warp.style.cssText="transform: translate3d(0, "+1*this.warpH+"px, 0); transition: transform .5s",setTimeout(function(){n._warp.style.cssText="transform: translate3d(0, "+-(n._mainLen-1)*n.warpH+"px, 0);"},550)):this._warp.style.cssText="transform: translate3d(0, -"+t*this.warpH+"px, 0); transition: transform .5s",t===this._mainLen&&(this.index=0,setTimeout(function(){n._warp.style.cssText="transform: translate3d(0, 0, 0);"},550)),this.attrs.point&&this.handlePoint(t)}},{key:"handlePlayer",value:function(){var t=this;this.interval=setInterval(function(){t.next()},this.attrs.time)}}]),n}();